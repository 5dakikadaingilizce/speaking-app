<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>5 Dakikada ƒ∞ngilizce - Practice v2.6</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <style>
        :root {
            --bg-dark: #0f172a; --card-bg: rgba(30, 41, 59, 0.85);
            --primary: #38bdf8; --secondary: #2dd4bf; --accent: #fb7185;
            --text-main: #f8fafc; --logo-grad: linear-gradient(90deg, #ff4d4d, #f97316);
        }
        body {
            margin: 0; font-family: 'Inter', sans-serif; 
            background: radial-gradient(circle at top right, #1e293b, #0f172a);
            height: 100vh; display: flex; justify-content: center; align-items: center; 
            color: var(--text-main); overflow: hidden; position: relative;
        }
        .app {
            background: var(--card-bg); backdrop-filter: blur(15px); -webkit-backdrop-filter: blur(15px);
            padding: 30px; border-radius: 35px; width: 88%; max-width: 420px; text-align: center; 
            border: 1px solid rgba(255, 255, 255, 0.1); box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.6);
        }
        .app-logo { width: 80px; height: 80px; margin-bottom: 10px; object-fit: contain; }
        h2 { font-size: 11px; text-transform: uppercase; letter-spacing: 3px; color: #94a3b8; margin: 0; }
        .sub-title { font-size: 19px; font-weight: 900; margin: 5px 0 15px 0; background: var(--logo-grad); -webkit-background-clip: text; -webkit-text-fill-color: transparent; }
        .phrase-container { min-height: 110px; display: flex; flex-direction: column; justify-content: center; margin: 10px 0; }
        #phrase { font-size: 28px; font-weight: 800; color: var(--secondary); margin: 0; line-height: 1.2; }
        #translation { font-size: 18px; color: #94a3b8; margin-top: 10px; font-style: italic; opacity: 0; transition: 0.3s; }
        #translation.visible { opacity: 1; }
        .start { 
            background: linear-gradient(135deg, #38bdf8, #0ea5e9); color: #0f172a; 
            width: 100%; padding: 20px; border-radius: 20px; font-size: 18px; font-weight: 800;
            border: none; cursor: pointer; animation: pulse 2.5s infinite; transition: 0.3s;
        }
        @keyframes pulse { 0% { transform: scale(1); } 50% { transform: scale(1.02); } 100% { transform: scale(1); } }
        .ctrl-container { display: flex; gap: 8px; margin: 15px 0; flex-wrap: wrap; }
        .ctrl { background: rgba(51, 65, 85, 0.7); color: white; flex: 1; padding: 14px; border-radius: 14px; border: 1px solid rgba(255,255,255,0.05); font-weight: 600; font-size: 12px; cursor: pointer; }
        .btn-pass { background: rgba(251, 113, 133, 0.15); color: var(--accent); border: 1px solid rgba(251, 113, 133, 0.3); }
        .btn-translate { width: 100%; background: rgba(45, 212, 191, 0.2); color: var(--secondary); border: 1px solid var(--secondary); margin-top: 5px; }
        #result { font-size: 14px; font-weight: 700; margin: 10px 0; height: 30px; }
        .stats { margin-top: 10px; font-size: 10px; color: #94a3b8; background: rgba(15, 23, 42, 0.4); padding: 12px; border-radius: 20px; display: grid; grid-template-columns: 1fr 1fr; gap: 8px; }
        .stat-item { display: flex; justify-content: space-between; align-items: center; padding: 0 5px; }
        .stat-value { color: var(--primary); font-weight: 800; font-size: 13px; }
    </style>
</head>
<body>

<div class="app">
    <img src="logo.png" alt="Logo" class="app-logo">
    <h2>5 Dakikada ƒ∞ngilizce</h2>
    <div class="sub-title">SPEAKING PRACTICE</div>
    
    <div class="phrase-container">
        <div id="phrase">Loading...</div>
        <div id="translation">T√ºrk√ße √áeviri</div>
    </div>

    <button class="start" id="startBtn">TAP TO SPEAK</button>
    
    <div class="ctrl-container">
        <button class="ctrl" id="listenBtn">LISTEN</button>
        <button class="ctrl" id="backBtn">BACK</button>
        <button class="ctrl btn-pass" id="passBtn">PASS ‚è≠Ô∏è</button>
        <button class="ctrl btn-translate" id="toggleTransBtn">SHOW TRANSLATION</button>
    </div>

    <div id="result"></div>

    <div class="stats">
        <div class="stat-item">ORDER: <span class="stat-value" id="current">1</span></div>
        <div class="stat-item">TOTAL: <span class="stat-value" id="total">0</span></div>
        <div class="stat-item">‚úÖ COMPLETED: <span class="stat-value" id="correct" style="color:#2dd4bf">0</span></div>
        <div class="stat-item">‚è≥ REMAINING: <span class="stat-value" id="remaining" style="color:#f8fafc">0</span></div>
    </div>
</div>

<script>
// --- VERƒ∞ D√úZENLEME VE √áEVƒ∞Rƒ∞ MOTORU ---
const nouns = [
    {en:"day", tr:"g√ºn", type:"soft"}, {en:"monday", tr:"pazartesi", type:"soft"}, {en:"car", tr:"araba", type:"hard"},
    // ... (Diƒüer 280 isim buraya gelecek, mantƒ±k aynƒ±)
    {en:"child", tr:"√ßocuk", type:"hard"}, {en:"school", tr:"okul", type:"hard"}
];

const preps = [
    {en:"of", trS:"ƒ±n/in/un/√ºn", trE:"ƒ±n/in/un/√ºn", type:"suffix"}, 
    {en:"to", trS:"a/e", trE:"a/e", type:"suffix"},
    {en:"for", trS:"i√ßin", trE:"i√ßin", type:"end"},
    {en:"from", trS:"dan/den", trE:"dan/den", type:"suffix"},
    {en:"with", trS:"ile", trE:"ile", type:"end"},
    {en:"without", trS:"olmadan", trE:"olmadan", type:"end"}
];

const dets = [
    {en:"a/an", tr:"bir"}, {en:"the", tr:""}, {en:"my", tr:"benim"}, {en:"your", tr:"senin"}, {en:"two", tr:"iki"}
];

let data = [];
// Dinamik Veri √úretici & Akƒ±llƒ± √áeviri
function buildData() {
    nouns.forEach(n => {
        preps.forEach(p => {
            dets.forEach(d => {
                let fD = d.en; let fN = n.en;
                if(d.en === "a/an") fD = (/^[aeiou]/i.test(n.en)) ? "an" : "a";
                if(d.en === "two") {
                    const irr = {"child":"children","man":"men","woman":"women"};
                    fN = irr[n.en] || n.en + "s";
                }
                let eng = `${p.en} ${fD} ${fN}`.replace(/\s+/g, ' ');
                
                // Geli≈ümi≈ü T√ºrk√ße √áeviri Mantƒ±ƒüƒ±
                let tur = "";
                let nTr = (d.en === "two") ? n.tr + "lar" : n.tr;
                
                if(d.en === "my") nTr = n.tr + (n.type === "soft" ? "√ºm" : "ƒ±m");
                if(d.en === "your") nTr = n.tr + (n.type === "soft" ? "√ºn" : "ƒ±n");

                if(p.type === "suffix") {
                    let suffix = (n.type === "soft") ? p.trS.split('/')[1] : p.trS.split('/')[0];
                    tur = `${d.tr ? d.tr + ' ' : ''}${nTr}${suffix}`;
                } else {
                    tur = `${d.tr ? d.tr + ' ' : ''}${nTr} ${p.trS}`;
                }
                data.push({ en: eng, tr: tur.trim() });
            });
        });
    });
}
buildData();

let index = 0, correctTotal = 0;
const phraseEl = document.getElementById("phrase");
const transEl = document.getElementById("translation");
const resultEl = document.getElementById("result");
const startBtn = document.getElementById("startBtn");

function render() {
    const item = data[index];
    phraseEl.textContent = item.en;
    transEl.textContent = item.tr;
    document.getElementById("current").textContent = index + 1;
    document.getElementById("total").textContent = data.length + correctTotal;
    document.getElementById("correct").textContent = correctTotal;
    document.getElementById("remaining").textContent = data.length;
}

// PASS Sƒ∞STEMƒ∞
document.getElementById("passBtn").onclick = () => {
    const item = data.splice(index, 1)[0];
    data.push(item);
    resultEl.innerHTML = '<span style="color:#94a3b8">‚è≠Ô∏è SONA ATILDI</span>';
    setTimeout(() => { resultEl.innerHTML = ""; render(); }, 600);
};

const SR = window.SpeechRecognition || window.webkitSpeechRecognition;
const rec = new SR();
rec.lang = "en-US";

rec.onstart = () => { 
    startBtn.innerText = "LISTENING..."; 
    startBtn.style.background = "linear-gradient(135deg, #fb7185, #e11d48)"; 
    startBtn.style.animation = "none"; 
};

rec.onresult = e => {
    const spoken = e.results[0][0].transcript.toLowerCase().trim();
    const target = data[index].en.toLowerCase().trim();

    // HASSASƒ∞YET AYARI (Fuzzy Logic)
    const targetWords = target.split(" ");
    const spokenWords = spoken.split(" ");
    let matches = 0;
    targetWords.forEach(w => { if(spokenWords.includes(w)) matches++; });
    const successRatio = matches / targetWords.length;

    if (spoken === target || successRatio >= 0.65) {
        correctTotal++;
        resultEl.innerHTML = '<span style="color:#2dd4bf">EXCELLENT! ‚úÖ</span>';
        setTimeout(() => {
            data.splice(index, 1);
            resultEl.innerHTML = "";
            if(data.length > 0) {
                if(index >= data.length) index = 0;
                render();
            } else {
                phraseEl.textContent = "üèÜ COMPLETED!";
            }
        }, 1000);
    } else {
        resultEl.innerHTML = `<span style="color:#fb7185">TRY AGAIN ‚ùå</span> <small style="display:block; font-size:10px; color:#64748b">Heard: ${spoken}</small>`;
    }
};

rec.onend = () => { 
    startBtn.innerText = "TAP TO SPEAK"; 
    startBtn.style.background = ""; 
    startBtn.style.animation = "pulse 2.5s infinite"; 
};

startBtn.onclick = () => rec.start();
document.getElementById("listenBtn").onclick = () => {
    const u = new SpeechSynthesisUtterance(data[index].en);
    u.lang = "en-US"; window.speechSynthesis.speak(u);
};
document.getElementById("toggleTransBtn").onclick = () => transEl.classList.toggle("visible");
document.getElementById("backBtn").onclick = () => { if(index > 0) index--; render(); };

render();
</script>
</body>
</html>
